---
import { teamMembers } from "../data/teamMembers";
---
<div class="w-full relative md:pt-10 lg:pt-20 xl:pt-30 overflow-x-hidden">
  <div class="relative w-full sm:mb-4 sm:pb-8 lg:mb-32 lg:pb-25">
    <div class="relative w-full flex justify-center items-center min-h-[300px]">
      
      <img 
        src="src/assets/team/new_set/board.svg" 
        class="absolute -left-12 top-1/2 -translate-y-1/2 w-[25vw] max-w-[500px] h-auto z-10" 
      />
      
      <img 
        src="src/assets/team/new_set/film_reel_circle.svg" 
        class="absolute -right-12 top-1/2 -translate-y-1/2 w-[24vw] max-w-[350px] h-auto z-10" 
      />

      <img 
        src="src/assets/team/new_set/film_reel.svg" 
        class="absolute left-1/2 transform -translate-x-1/2 w-full h-auto scale-105 opacity-70"
      />
      
      <div class="relative z-20 text-center py-8 max-w-7xl mx-auto">
        <h2 class="text-3xl md:text-5xl lg:text-7xl font-bold text-gold">Meet the Team</h2>
      </div>
    </div>
  </div>

  <div class="max-w-6xl mx-auto my-16 relative z-30">
    <div class="relative">
      <img 
        src="src/assets/team/new_set/film_reel_large.svg" 
        class="w-full h-auto scale-165 left-1/2" 
      />
      
      <div id="memberContainer" class="absolute inset-0">
        <button id="prevBtn" class="absolute left-2 md:left-4 lg:left-2 xl:-left-20 2xl:-left-50 top-1/2 -translate-y-1/2 text-white text-4xl md:text-5xl lg:text-7xl hover:text-yellow-400 transition z-50 drop-shadow-lg">
          â€¹
        </button>
        
        <div class="absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-[120%] lg:-left-20 lg:translate-x-0 flex flex-col items-center">
          <div class="relative transform">
            <img 
              id="teamPhoto" 
              src="" 
              class="w-48 h-56 lg:w-180 lg:h-120 object-cover rounded-lg shadow-2xl grayscale"
            />
          </div>
        </div>
        
        <div class="absolute top-1/2 -translate-y-1/2 right-1/2 translate-x-[120%] lg:right-20 lg:translate-x-0 flex flex-col lg:gap-4 w-40 lg:w-64">
          <div class="-rotate-6 transform transition-transform hover:rotate-0">
            <img 
              id="memberPhoto" 
              src="" 
              class="w-32 h-32 lg:w-48 lg:h-48 object-cover"
            />
            <div class="absolute -top-2 right-12 text-3xl lg:text-5xl">
              ðŸ“Ž
            </div>-
          </div>

          <div class="flex flex-col gap-2 lg:gap-3 lg:mt-12">
            <h3 id="memberName" class="text-xl lg:text-4xl font-bold text-gold drop-shadow-lg text-left lg:whitespace-nowrap">
            </h3>
            <p id="memberInfo" class="text-sm lg:text-xl text-white text-left drop-shadow-lg font-bold mt-0 lg:mt-4">
            </p>
            <p id="memberTitle" class="text-sm lg:text-xl text-white text-left drop-shadow-lg font-bold mt-0 lg:mt-4">
            </p>
          </div>
        </div>
        
        <button id="nextBtn" class="absolute right-2 md:right-4 lg:right-2 xl:-right-20 2xl:-right-50 top-1/2 -translate-y-1/2 text-white text-4xl md:text-5xl lg:text-7xl hover:text-yellow-400 transition z-50 drop-shadow-lg">
          â€º
        </button>
      </div>
      
      <div id="pagination" class="absolute -bottom-8 lg:-bottom-15 left-1/2 transform -translate-x-1/2 flex justify-center gap-2 z-20">
      </div>
    </div>
  </div>

  <div class="flex flex-wrap justify-center gap-4 lg:gap-12 mt-24 md:mt-40 lg:mt-50 max-w-lg lg:max-w-none mx-auto">

    <button class="team-filter px-4 py-2 lg:px-6 text-sm lg:text-base rounded-full border-2 border-white bg-white text-black hover:bg-white hover:text-black transition" data-team="Director">
      ðŸŽ¬ Directors
    </button>
    <button class="team-filter px-4 py-2 lg:px-6 text-sm lg:text-base rounded-full border-2 border-white text-white hover:bg-white hover:text-black transition" data-team="Logistics">
      ðŸ“° Logistics
    </button>
    <button class="team-filter px-4 py-2 lg:px-6 text-sm lg:text-base rounded-full border-2 border-white text-white hover:bg-white hover:text-black transition" data-team="Experience">
      ðŸ“£ Experience
    </button>
    <button class="team-filter px-4 py-2 lg:px-6 text-sm lg:text-base rounded-full border-2 border-white text-white hover:bg-white hover:text-black transition" data-team="Web Development">
      ðŸ’» Web Dev
    </button>
    <button class="team-filter px-4 py-2 lg:px-6 text-sm lg:text-base rounded-full border-2 border-white text-white hover:bg-white hover:text-black transition" data-team="Communications">
      ðŸ“ž Communications
    </button>
    <button class="team-filter px-4 py-2 lg:px-6 text-sm lg:text-base rounded-full border-2 border-white text-white hover:bg-white hover:text-black transition" data-team="Outreach">
      ðŸ’¬ Outreach
    </button>
  </div>
</div>

<script define:vars={{ teamMembers }}>
  let currentIndex = 0;
  let filteredMembers = teamMembers.filter(member => member.title.includes('Director'));
  
  function updateDisplay() {
    const paginationDiv = document.getElementById('pagination');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    
    const member = filteredMembers[currentIndex];
    
    document.getElementById('memberName').textContent = member.name;
    document.getElementById('memberInfo').textContent = `${member.year} | ${member.major}`;
    document.getElementById('memberTitle').textContent = member.title;
    document.getElementById('memberPhoto').src = member.image;
    
    const teamPhotoMap = {
      'Director': '/teams/director.JPG',
      'Logistics': '/teams/logistics.JPG',
      'Experience': '/teams/experience.JPG',
      'Web Development': '/teams/web_dev.JPG',
      'Communications': '/teams/communications.JPG',
      'Outreach': '/teams/outreach.JPG'
    };
    
    const teamPhotoElement = document.querySelector('#memberContainer #teamPhoto');
    for (const [teamName, photoPath] of Object.entries(teamPhotoMap)) {
      if (member.title.includes(teamName)) {
        teamPhotoElement.src = photoPath;
        break;
      }
    }
    
    if (currentIndex === 0) {
      prevBtn.disabled = true;
      prevBtn.classList.add('opacity-30');
      prevBtn.classList.remove('hover:text-yellow-400');
    } else {
      prevBtn.disabled = false;
      prevBtn.classList.remove('opacity-30');
      prevBtn.classList.add('hover:text-yellow-400');
    }
    
    if (currentIndex === filteredMembers.length - 1) {
      nextBtn.disabled = true;
      nextBtn.classList.add('opacity-30');
      nextBtn.classList.remove('hover:text-yellow-400');
    } else {
      nextBtn.disabled = false;
      nextBtn.classList.remove('opacity-30');
      nextBtn.classList.add('hover:text-yellow-400');
    }
    
    paginationDiv.innerHTML = '';
    
    filteredMembers.forEach((_, index) => {
      const dot = document.createElement('span');
      dot.className = `w-3 h-3 rounded-full ${index === currentIndex ? 'bg-white' : 'bg-gray-500'} cursor-pointer`;
      dot.addEventListener('click', () => {
        currentIndex = index;
        updateDisplay();
      });
      paginationDiv.appendChild(dot);
    });
  }
  
  function filterTeam(team) {
    filteredMembers = teamMembers.filter(member => 
      member.title.includes(team)
    );
    currentIndex = 0;
    updateDisplay();
  }
  
  document.getElementById('prevBtn').addEventListener('click', () => {
    if (!document.getElementById('prevBtn').disabled) {
      currentIndex = currentIndex - 1;
      updateDisplay();
    }
  });
  
  document.getElementById('nextBtn').addEventListener('click', () => {
    if (!document.getElementById('nextBtn').disabled) {
      currentIndex = currentIndex + 1;
      updateDisplay();
    }
  });
  
  document.querySelectorAll('.team-filter').forEach(btn => {
    btn.addEventListener('click', (e) => {

      document.querySelectorAll('.team-filter').forEach(b => {
        b.classList.remove('bg-white', 'text-black');
        b.classList.add('text-white');
      });

      e.target.classList.remove('text-white');
      e.target.classList.add('bg-white', 'text-black');
      
      const team = e.target.dataset.team;
      filterTeam(team);
    });
  });
  
  updateDisplay();
</script>